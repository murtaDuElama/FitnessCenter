@model List<Randevu>

@{
    ViewData["Title"] = "Randevu Yönetimi";
}

<!-- Bootstrap Icons -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">

<style>
    .admin-card {
        border-radius: 12px;
        padding: 20px;
        background: #fff;
        box-shadow: 0px 4px 18px rgba(0,0,0,0.08);
    }

    .table-hover tbody tr:hover {
        background-color: #eef4ff;
    }

    .status-badge {
        padding: 6px 12px;
        border-radius: 20px;
        font-size: 0.85rem;
        font-weight: 600;
    }

    .action-btn {
        display: inline-flex;
        align-items: center;
        gap: 4px;
        padding: 5px 10px;
        border-radius: 6px;
    }

</style>

<div class="container mt-4">

    <h2 class="mb-4 text-primary fw-bold">
        <i class="bi bi-calendar-check"></i> Randevu Yönetimi
    </h2>

    @if (TempData["Success"] != null)
    {
        <div class="alert alert-success">@TempData["Success"]</div>
    }
    @if (TempData["Delete"] != null)
    {
        <div class="alert alert-danger">@TempData["Delete"]</div>
    }

    <div class="admin-card">

        <table class="table table-bordered table-striped table-hover align-middle">
            <thead class="table-dark">
                <tr>
                    <th><i class="bi bi-calendar-event"></i> Tarih</th>
                    <th><i class="bi bi-clock"></i> Saat</th>
                    <th><i class="bi bi-person-fill"></i> Üye</th>
                    <th><i class="bi bi-list-task"></i> Hizmet</th>
                    <th><i class="bi bi-person-workspace"></i> Antrenör</th>
                    <th><i class="bi bi-flag"></i> Durum</th>
                    <th style="width: 280px;">İşlemler</th>
                </tr>
            </thead>

            <tbody>
                @foreach (var r in Model)
                {
                    <tr>
                        <td>@r.Tarih.ToShortDateString()</td>
                        <td>@r.Saat</td>
                        <td>@r.User?.AdSoyad</td>
                        <td>@r.Hizmet?.Ad</td>
                        <td>@r.Antrenor?.AdSoyad</td>

                        <td>
                            @if (r.Onaylandi)
                            {
                                <span class="status-badge bg-success text-white">
                                    <i class="bi bi-check-circle"></i> Onaylandı
                                </span>
                            }
                            else
                            {
                                <span class="status-badge bg-warning text-dark">
                                    <i class="bi bi-hourglass-split"></i> Bekliyor
                                </span>
                            }
                        </td>

                        <td>

                            <div class="d-flex gap-2">

                                <!-- ONAYLAMA BUTTON -->
                                @if (!r.Onaylandi)
                                {
                                    <form asp-action="Onayla" method="post">
                                        <input type="hidden" name="id" value="@r.Id" />
                                        <button type="submit"
                                                class="btn btn-success btn-sm action-btn">
                                            <i class="bi bi-check-lg"></i> Onayla
                                        </button>
                                    </form>
                                }

                                <!-- DÜZENLE BUTTON -->
                                <a href="/Admin/Randevu/Edit/@r.Id"
                                   class="btn btn-primary btn-sm action-btn">
                                    <i class="bi bi-pencil-square"></i> Düzenle
                                </a>

                                <!-- SİL BUTTON -->
                                <form asp-action="Sil" method="post"
                                      onsubmit="return confirm('Bu randevuyu silmek istediğinize emin misiniz?');">
                                    <input type="hidden" name="id" value="@r.Id" />
                                    <button type="submit"
                                            class="btn btn-danger btn-sm action-btn">
                                        <i class="bi bi-trash"></i> Sil
                                    </button>
                                </form>

                            </div>

                        </td>
                    </tr>
                }
            </tbody>

        </table>

    </div>
</div>
